// hooks/useSampleSettings.ts
import { useCallback } from 'react';
import { useSamplerCtx } from '../contexts/SamplerCtx';
import {
  Time_settings,
  Volume_settings,
  Sample_settings,
} from '../types/samples';

export const useSampleSettings = () => {
  const { latestSelectedSample, updateTimeSettings, updateEnvelopeSettings } =
    useSamplerCtx();

  const handleSettingChange = useCallback(
    (settingKey: string, value: number) => {
      if (!latestSelectedSample) return; // Consider throwing an error here if appropriate

      try {
        if (
          settingKey ===
          ('startPoint' || 'endPoint' || 'loopStart' || 'loopEnd')
        ) {
          updateTimeSettings(latestSelectedSample.id, settingKey, value);
        }
        if (settingKey === ('attackTime' || 'releaseTime')) {
          updateEnvelopeSettings(latestSelectedSample.id, settingKey, value);
        }
      } catch (error) {
        console.error('Error updating sample settings:', error);
      }
    },
    [latestSelectedSample, updateTimeSettings, updateEnvelopeSettings]
  );

  return { handleSettingChange };
};
// const C5_DURATION_SEC = 0.00191117077819399; // just a constant for now

// const { sample_settings: settings } = latestSelectedSample; // deconstruct or not??

// ____________ MOVE THIS TO MORE APPROPRIATE PLACE ____________
// let newloopstart: number = 0;
// let newloopend: number = 0;
// let newlooplength: number = 0;
// if (settingKey === 'loopStart' || settingKey === 'loopEnd') {
//   newloopstart = settingKey === 'loopStart' ? value : settings.loopStart;
//   newloopstart = settingKey === 'loopEnd' ? value : settings.loopEnd;

//   newlooplength =
//     newloopend > newloopstart ? newloopend - newloopstart : 0;

//   if (newlooplength < 0.0019) {
//     // 0.0019 is the minimum loop length (around C5)
//     return;
//   }
// }
// ____________ MOVE THIS TO MORE APPROPRIATE PLACE ____________
